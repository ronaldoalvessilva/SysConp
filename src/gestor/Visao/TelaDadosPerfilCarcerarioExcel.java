/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package gestor.Visao;

import gestor.Dao.ConexaoBancoDados;
import gestor.Dao.ModeloTabela;
import java.awt.Desktop;
import java.awt.Rectangle;
import java.io.File;
import java.io.FileOutputStream;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import javax.swing.JOptionPane;
import javax.swing.ListSelectionModel;
import javax.swing.SwingConstants;
import javax.swing.table.DefaultTableCellRenderer;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

/**
 *
 * @author Ronaldo
 */
public class TelaDadosPerfilCarcerarioExcel extends javax.swing.JDialog {

    ConexaoBancoDados conecta = new ConexaoBancoDados();
    //
    int flag;
    int count = 0;
    String dataInicial;
    String dataFinal;
    private final String ruta = System.getProperties().getProperty("user.dir");
    public static TelaPerfilCarcerario telaPerfilCarcerario;

    /**
     * Creates new form TelaDadosPerfilCarcerarioExcel
     */
    public TelaDadosPerfilCarcerarioExcel(TelaPerfilCarcerario parent, boolean modal) {
        this.telaPerfilCarcerario = parent;
        this.setModal(modal);
        setLocationRelativeTo(telaPerfilCarcerario);
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jDataInicial = new com.toedter.calendar.JDateChooser();
        jDataFinal = new com.toedter.calendar.JDateChooser();
        jBtPesquisarData = new javax.swing.JButton();
        jCheckBox1 = new javax.swing.JCheckBox();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTabelaPerfilCarcerarioInternos = new javax.swing.JTable();
        jProgressBar1 = new javax.swing.JProgressBar();
        jPanel31 = new javax.swing.JPanel();
        jPanel32 = new javax.swing.JPanel();
        jtotalRegistros = new javax.swing.JLabel();
        jPanel30 = new javax.swing.JPanel();
        jLabel67 = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        jBtSair = new javax.swing.JButton();
        jBtExportarExcel = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        jLabel3 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("...::: Exportar Dados Perfil Carcário para Excel :::...");

        jPanel1.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(204, 204, 204), 1, true));

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel1.setText("Data Inicial:");

        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel2.setText("Data Final:");

        jDataInicial.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));

        jDataFinal.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));

        jBtPesquisarData.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jBtPesquisarData.setForeground(new java.awt.Color(0, 0, 255));
        jBtPesquisarData.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gestor/Imagens/Lupas_1338_05.gif"))); // NOI18N
        jBtPesquisarData.setText("Buscar");
        jBtPesquisarData.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtPesquisarDataActionPerformed(evt);
            }
        });

        jCheckBox1.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jCheckBox1.setText("Todos");
        jCheckBox1.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jCheckBox1ItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap(14, Short.MAX_VALUE)
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jDataInicial, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel2)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jDataFinal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jBtPesquisarData)
                .addGap(18, 18, 18)
                .addComponent(jCheckBox1)
                .addContainerGap())
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jCheckBox1)
                    .addComponent(jBtPesquisarData)
                    .addComponent(jLabel1)
                    .addComponent(jDataFinal, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel2)
                    .addComponent(jDataInicial, javax.swing.GroupLayout.PREFERRED_SIZE, 19, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(15, Short.MAX_VALUE))
        );

        jTabelaPerfilCarcerarioInternos.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
        jTabelaPerfilCarcerarioInternos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Nome do Interno", "Ano Nasc.", "Sexo", "Opção Sexual", "Escolaridade", "Pavilhão", "Cor/Etinia", "RG", "CPF", "Cidade", "Bairro", "RF", "CF", "FSRP", "F>21", "F<21", "FRBG", "TV", "FEU", "FENEN", "AL", "Int.Trab.", "TCA", "TM", "USOD", "USAD", "HIP", "DIAB", "TUB", "SIF", "HIV", "HEP", "HAN", "ART", "REU", "AF"
            }
        ));
        jScrollPane1.setViewportView(jTabelaPerfilCarcerarioInternos);
        if (jTabelaPerfilCarcerarioInternos.getColumnModel().getColumnCount() > 0) {
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(0).setMinWidth(270);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(0).setMaxWidth(270);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(1).setMinWidth(60);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(1).setMaxWidth(60);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(2).setMinWidth(80);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(2).setMaxWidth(80);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(3).setMinWidth(100);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(3).setMaxWidth(100);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(4).setMinWidth(100);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(4).setMaxWidth(100);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(5).setMinWidth(100);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(5).setMaxWidth(100);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(6).setMinWidth(80);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(6).setMaxWidth(80);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(7).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(7).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(8).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(8).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(9).setMinWidth(220);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(9).setMaxWidth(220);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(10).setMinWidth(150);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(10).setMaxWidth(150);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(11).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(11).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(12).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(12).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(13).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(13).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(14).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(14).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(15).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(15).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(16).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(16).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(17).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(17).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(18).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(18).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(19).setMinWidth(50);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(19).setMaxWidth(50);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(20).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(20).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(21).setMinWidth(80);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(21).setMaxWidth(80);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(22).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(22).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(23).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(23).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(24).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(24).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(25).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(25).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(26).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(26).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(27).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(27).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(28).setMinWidth(100);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(28).setMaxWidth(100);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(29).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(29).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(30).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(30).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(31).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(31).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(32).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(32).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(33).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(33).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(34).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(34).setMaxWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(35).setMinWidth(40);
            jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(35).setMaxWidth(40);
        }

        jProgressBar1.setStringPainted(true);

        jPanel31.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED)));

        javax.swing.GroupLayout jPanel31Layout = new javax.swing.GroupLayout(jPanel31);
        jPanel31.setLayout(jPanel31Layout);
        jPanel31Layout.setHorizontalGroup(
            jPanel31Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        jPanel31Layout.setVerticalGroup(
            jPanel31Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 14, Short.MAX_VALUE)
        );

        jPanel32.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED)));

        jtotalRegistros.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);

        javax.swing.GroupLayout jPanel32Layout = new javax.swing.GroupLayout(jPanel32);
        jPanel32.setLayout(jPanel32Layout);
        jPanel32Layout.setHorizontalGroup(
            jPanel32Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jtotalRegistros, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 60, Short.MAX_VALUE)
        );
        jPanel32Layout.setVerticalGroup(
            jPanel32Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jtotalRegistros, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 14, Short.MAX_VALUE)
        );

        jPanel30.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED)));

        jLabel67.setText("Total de Registros:");

        javax.swing.GroupLayout jPanel30Layout = new javax.swing.GroupLayout(jPanel30);
        jPanel30.setLayout(jPanel30Layout);
        jPanel30Layout.setHorizontalGroup(
            jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel30Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel67))
        );
        jPanel30Layout.setVerticalGroup(
            jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLabel67)
        );

        jPanel2.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(204, 204, 204), 1, true));

        jBtSair.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jBtSair.setForeground(new java.awt.Color(255, 0, 0));
        jBtSair.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gestor/Imagens/shutdown-icone-6920-32.png"))); // NOI18N
        jBtSair.setText("Sair");
        jBtSair.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtSairActionPerformed(evt);
            }
        });

        jBtExportarExcel.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jBtExportarExcel.setForeground(new java.awt.Color(0, 153, 0));
        jBtExportarExcel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/gestor/Imagens/xls.png"))); // NOI18N
        jBtExportarExcel.setText("Exportar");
        jBtExportarExcel.setToolTipText("Exportar para Excel");
        jBtExportarExcel.setEnabled(false);
        jBtExportarExcel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jBtExportarExcelActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jBtExportarExcel)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 147, Short.MAX_VALUE)
                .addComponent(jBtSair, javax.swing.GroupLayout.PREFERRED_SIZE, 104, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel2Layout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[] {jBtExportarExcel, jBtSair});

        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jBtExportarExcel)
                    .addComponent(jBtSair, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );

        jPanel3.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(204, 204, 204), 1, true));

        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(255, 0, 0));
        jLabel3.setText("OBS.: Antes de exportar os dados para Excel, verifique se todos os campos da tabela abaixo estão preenchidos. Caso não estejam não será possível exportar.");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel3)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jScrollPane1)
                    .addComponent(jProgressBar1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel30, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel32, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel31, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 302, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jProgressBar1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                    .addComponent(jPanel30, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel32, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel31, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void jBtPesquisarDataActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtPesquisarDataActionPerformed
        // TODO add your handling code here:
        count = 0;
        flag = 1;
        jBtExportarExcel.setEnabled(true);
        if (jDataInicial.getDate() == null) {
            JOptionPane.showMessageDialog(rootPane, "Informe a data inicial para pesquisa.");
            jDataInicial.requestFocus();
        } else {
            if (jDataFinal.getDate() == null) {
                JOptionPane.showMessageDialog(rootPane, "Informe a data final para pesquisa.");
                jDataFinal.requestFocus();
            } else {
                if (jDataInicial.getDate().after(jDataFinal.getDate())) {
                    JOptionPane.showMessageDialog(rootPane, "Data Inicial não pode ser maior que data final");
                } else {
                    SimpleDateFormat formatoAmerica = new SimpleDateFormat("dd/MM/yyyy");
                    dataInicial = formatoAmerica.format(jDataInicial.getDate().getTime());
                    dataFinal = formatoAmerica.format(jDataFinal.getDate().getTime());
                    preencherTabelaPerfilCarcerario("SELECT * FROM PERFIL_CARCERARIO "
                            + "INNER JOIN PERFIL_CARCERARIO_INTERNO "
                            + "ON PERFIL_CARCERARIO.IdPerfil=PERFIL_CARCERARIO_INTERNO.IdPerfil "
                            + "INNER JOIN PRONTUARIOSCRC "
                            + "ON PRONTUARIOSCRC.IdInternoCrc=PERFIL_CARCERARIO.IdInternoCrc "
                            + "INNER JOIN DADOSFISICOSINTERNOS "
                            + "ON PRONTUARIOSCRC.IdInternoCrc=DADOSFISICOSINTERNOS.IdInternoCrc "
                            + "INNER JOIN DADOSPENAISINTERNOS "
                            + "ON PRONTUARIOSCRC.IdInternoCrc=DADOSPENAISINTERNOS.IdInternoCrc "
                            + "INNER JOIN CIDADES "
                            + "ON PRONTUARIOSCRC.IdCidade=CIDADES.IdCidade "
                            + "INNER JOIN ITENSLOCACAOINTERNO "
                            + "ON PRONTUARIOSCRC.IdInternoCrc=ITENSLOCACAOINTERNO.IdInternoCrc "
                            + "INNER JOIN CELAS "
                            + "ON ITENSLOCACAOINTERNO.IdCela=CELAS.IdCela "
                            + "INNER JOIN PAVILHAO ON CELAS.IdPav=PAVILHAO.IdPav "
                            + "WHERE DataPerfil BETWEEN'" + dataInicial + "'AND '" + dataFinal + "'");
                }
            }
        }
    }//GEN-LAST:event_jBtPesquisarDataActionPerformed

    private void jBtExportarExcelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtExportarExcelActionPerformed
        // TODO add your handling code here:     
        Integer rows = jTabelaPerfilCarcerarioInternos.getModel().getRowCount();
        if (rows == 0) {
            JOptionPane.showMessageDialog(rootPane, "Não existe registros a ser exportado.");
        } else {
            try {
                Thread t = new Thread() {
                    public void run() {
                        XSSFWorkbook workbook = new XSSFWorkbook();
                        XSSFSheet hoja = workbook.createSheet();
                        XSSFRow fila = hoja.createRow(0);
                        fila.createCell(0).setCellValue("Nome do Interno");
                        fila.createCell(1).setCellValue("Ano Nasc.");
                        fila.createCell(2).setCellValue("Sexo");
                        fila.createCell(3).setCellValue("Opção Sexual");
                        fila.createCell(4).setCellValue("Escolaridade");
                        fila.createCell(5).setCellValue("Pavilhão");
                        fila.createCell(6).setCellValue("Cor/Etinia");
                        fila.createCell(7).setCellValue("RG");
                        fila.createCell(8).setCellValue("CPF");
                        fila.createCell(9).setCellValue("Cidade");
                        fila.createCell(10).setCellValue("Bairro");
                        fila.createCell(11).setCellValue("RF");
                        fila.createCell(12).setCellValue("CF");
                        fila.createCell(13).setCellValue("FSRP");
                        fila.createCell(14).setCellValue("F>21");
                        fila.createCell(15).setCellValue("F<21");
                        fila.createCell(16).setCellValue("FRBG");
                        fila.createCell(17).setCellValue("TV");
                        fila.createCell(18).setCellValue("FEU");
                        fila.createCell(19).setCellValue("FENEN");
                        fila.createCell(20).setCellValue("AL");
                        fila.createCell(21).setCellValue("Int.Tra.");
                        fila.createCell(22).setCellValue("TCA");
                        fila.createCell(23).setCellValue("TM");
                        fila.createCell(24).setCellValue("USOD");
                        fila.createCell(25).setCellValue("USAD");
                        fila.createCell(26).setCellValue("HIP");
                        fila.createCell(27).setCellValue("DIAB");
                        fila.createCell(28).setCellValue("TUB");
                        fila.createCell(29).setCellValue("SIF");
                        fila.createCell(30).setCellValue("HIV");
                        fila.createCell(31).setCellValue("HEP");
                        fila.createCell(32).setCellValue("HAN");
                        fila.createCell(33).setCellValue("ART");
                        fila.createCell(34).setCellValue("REU");
                        fila.createCell(35).setCellValue("AF");
                        jProgressBar1.setMaximum(jTabelaPerfilCarcerarioInternos.getRowCount());
                        XSSFRow filas;
                        Rectangle rect;
                        for (int i = 0; i < jTabelaPerfilCarcerarioInternos.getRowCount(); i++) {
                            rect = jTabelaPerfilCarcerarioInternos.getCellRect(i, 0, true);
                            try {
                                jTabelaPerfilCarcerarioInternos.scrollRectToVisible(rect);
                            } catch (java.lang.ClassCastException e) {
                            }
                            jTabelaPerfilCarcerarioInternos.setRowSelectionInterval(i, 1);
                            jProgressBar1.setValue((i + 1));
                            filas = hoja.createRow((i + 1));
                            filas.createCell(0).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 0).toString());
                            filas.createCell(1).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 1).toString());
                            filas.createCell(2).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 2).toString());
                            filas.createCell(3).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 3).toString());
                            filas.createCell(4).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 4).toString());
                            filas.createCell(5).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 5).toString());
                            filas.createCell(6).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 6).toString());
                            filas.createCell(7).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 7).toString());
                            filas.createCell(8).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 8).toString());
                            filas.createCell(9).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 9).toString());
                            filas.createCell(10).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 10).toString());
                            filas.createCell(11).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 11).toString());
                            filas.createCell(12).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 12).toString());
                            filas.createCell(13).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 13).toString());
                            filas.createCell(14).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 14).toString());
                            filas.createCell(15).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 15).toString());
                            filas.createCell(16).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 16).toString());
                            filas.createCell(17).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 17).toString());
                            filas.createCell(18).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 18).toString());
                            filas.createCell(19).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 19).toString());
                            filas.createCell(20).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 20).toString());
                            filas.createCell(21).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 21).toString());
                            filas.createCell(22).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 22).toString());
                            filas.createCell(23).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 23).toString());
                            filas.createCell(24).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 24).toString());
                            filas.createCell(25).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 25).toString());
                            filas.createCell(26).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 26).toString());
                            filas.createCell(27).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 27).toString());
                            filas.createCell(28).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 28).toString());
                            filas.createCell(29).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 29).toString());
                            filas.createCell(30).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 30).toString());
                            filas.createCell(31).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 31).toString());
                            filas.createCell(32).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 32).toString());
                            filas.createCell(33).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 33).toString());
                            filas.createCell(34).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 34).toString());
                            filas.createCell(35).setCellValue(jTabelaPerfilCarcerarioInternos.getValueAt(i, 35).toString());
                            try {
                                Thread.sleep(20);
                            } catch (InterruptedException ex) {
                            }
                        }
                        jProgressBar1.setValue(0);
                        try {
                            workbook.write(new FileOutputStream(new File(ruta + "//PerfilCarcerario.xlsx")));
                            Desktop.getDesktop().open(new File(ruta + "//PerfilCarcerario.xlsx"));
                        } catch (Exception e) {
                        }
                    }
                };
                t.start();
            } catch (Exception e) {
            }
        }
    }//GEN-LAST:event_jBtExportarExcelActionPerformed

    private void jBtSairActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jBtSairActionPerformed
        // TODO add your handling code here:
        dispose();
    }//GEN-LAST:event_jBtSairActionPerformed

    private void jCheckBox1ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_jCheckBox1ItemStateChanged
        // TODO add your handling code here:
        count = 0;
        flag = 1;
        jBtExportarExcel.setEnabled(true);
        if (evt.getStateChange() == evt.SELECTED) {
            this.preencherTabelaPerfilCarcerario("SELECT * FROM PERFIL_CARCERARIO "
                    + "INNER JOIN PERFIL_CARCERARIO_INTERNO "
                    + "ON PERFIL_CARCERARIO.IdPerfil=PERFIL_CARCERARIO_INTERNO.IdPerfil "
                    + "INNER JOIN PRONTUARIOSCRC "
                    + "ON PRONTUARIOSCRC.IdInternoCrc=PERFIL_CARCERARIO.IdInternoCrc "
                    + "INNER JOIN DADOSFISICOSINTERNOS "
                    + "ON PRONTUARIOSCRC.IdInternoCrc=DADOSFISICOSINTERNOS.IdInternoCrc "
                    + "INNER JOIN DADOSPENAISINTERNOS "
                    + "ON PRONTUARIOSCRC.IdInternoCrc=DADOSPENAISINTERNOS.IdInternoCrc "
                    + "INNER JOIN CIDADES "
                    + "ON PRONTUARIOSCRC.IdCidade=CIDADES.IdCidade "
                    + "INNER JOIN ITENSLOCACAOINTERNO "
                    + "ON PRONTUARIOSCRC.IdInternoCrc=ITENSLOCACAOINTERNO.IdInternoCrc "
                    + "INNER JOIN CELAS "
                    + "ON ITENSLOCACAOINTERNO.IdCela=CELAS.IdCela "
                    + "INNER JOIN PAVILHAO ON CELAS.IdPav=PAVILHAO.IdPav");
        } else {
            limparTabelaPerfilCarcerario();
            jBtExportarExcel.setEnabled(!true);
        }
    }//GEN-LAST:event_jCheckBox1ItemStateChanged

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(TelaDadosPerfilCarcerarioExcel.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(TelaDadosPerfilCarcerarioExcel.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(TelaDadosPerfilCarcerarioExcel.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TelaDadosPerfilCarcerarioExcel.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the dialog */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                TelaDadosPerfilCarcerarioExcel dialog = new TelaDadosPerfilCarcerarioExcel(telaPerfilCarcerario, true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {
                    @Override
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jBtExportarExcel;
    private javax.swing.JButton jBtPesquisarData;
    private javax.swing.JButton jBtSair;
    private javax.swing.JCheckBox jCheckBox1;
    private com.toedter.calendar.JDateChooser jDataFinal;
    private com.toedter.calendar.JDateChooser jDataInicial;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel67;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel30;
    private javax.swing.JPanel jPanel31;
    private javax.swing.JPanel jPanel32;
    private javax.swing.JProgressBar jProgressBar1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JTable jTabelaPerfilCarcerarioInternos;
    private javax.swing.JLabel jtotalRegistros;
    // End of variables declaration//GEN-END:variables

    public void preencherTabelaPerfilCarcerario(String sql) {
        ArrayList dados = new ArrayList();
        String[] Colunas = new String[]{"Nome do Interno", "Ano Nasc.", "Sexo", "Opção Sexual", "Escolaridade", "Pavilhão", "Cor/Etinia", "RG", "CPF", "Cidade", "Bairro", "RF", "CF", "FSRP", "F>21", "F<21", "FRBG", "TV", "FEU", "FENEN", "AL", "Int.Trab.", "TCA", "TM", "USOD", "USAD", "HIP", "DIAB", "TUB", "SIF", "HIV", "HEP", "HAN", "ART", "REU", "AF"};
        conecta.abrirConexao();
        try {
            conecta.executaSQL(sql);
            conecta.rs.first();
            do {
                count = count + 1;
                jtotalRegistros.setText(Integer.toString(count)); // Converter inteiro em string para exibir na tela
                dados.add(new Object[]{conecta.rs.getString("NomeInternoCrc"), conecta.rs.getString("AnoNasc"), conecta.rs.getString("SexoCrc"), conecta.rs.getString("OpcaoSexual"), conecta.rs.getString("Escolaridade"), conecta.rs.getString("DescricaoPav"), conecta.rs.getString("Cutis"), conecta.rs.getString("RG"), conecta.rs.getString("CPF"), conecta.rs.getString("CidadeCrc"), conecta.rs.getString("BairroCrc"), conecta.rs.getString("ResidenciaFixa"), conecta.rs.getString("ComposicaoFamiliar"), conecta.rs.getString("FilhosRecPaternidade"), conecta.rs.getString("FilhosMaior21"), conecta.rs.getString("FilhosMenor21"), conecta.rs.getString("FamiliaRecBeneGov"), conecta.rs.getString("TemVisita"), conecta.rs.getString("FrequentaEscolaUnid"), conecta.rs.getString("FezENEN"), conecta.rs.getString("AtividadeLabor"), conecta.rs.getString("InteresseTrabalhar"), conecta.rs.getString("CarteiraAssinada"), conecta.rs.getString("TranstornoMental"), conecta.rs.getString("UsouDrogas"), conecta.rs.getString("UsaDrogas"), conecta.rs.getString("Hipertensao"), conecta.rs.getString("Diabetes"), conecta.rs.getString("Tuberculose"), conecta.rs.getString("Sifilis"), conecta.rs.getString("HIV"), conecta.rs.getString("Hepatite"), conecta.rs.getString("Hanseniase"), conecta.rs.getString("Artigo"), conecta.rs.getString("Reu"), conecta.rs.getString("AnemiaFalsiforme")});
            } while (conecta.rs.next());
        } catch (SQLException ex) {
            JOptionPane.showMessageDialog(rootPane, "Não existem dados a serem EXIBIDOS !!!\nERRO: " + ex);
        }
        ModeloTabela modelo = new ModeloTabela(dados, Colunas);
        jTabelaPerfilCarcerarioInternos.setModel(modelo);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(0).setPreferredWidth(270);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(0).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(1).setPreferredWidth(60);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(1).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(2).setPreferredWidth(80);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(2).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(3).setPreferredWidth(100);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(3).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(4).setPreferredWidth(100);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(4).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(5).setPreferredWidth(100);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(5).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(6).setPreferredWidth(80);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(6).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(7).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(7).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(8).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(8).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(9).setPreferredWidth(220);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(9).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(10).setPreferredWidth(150);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(10).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(11).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(11).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(12).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(12).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(13).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(13).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(14).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(14).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(15).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(15).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(16).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(16).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(17).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(17).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(18).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(18).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(19).setPreferredWidth(50);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(19).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(20).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(20).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(21).setPreferredWidth(60);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(21).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(22).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(22).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(23).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(23).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(24).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(24).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(25).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(25).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(26).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(26).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(27).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(27).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(28).setPreferredWidth(80);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(28).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(29).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(29).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(30).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(30).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(31).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(31).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(32).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(32).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(33).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(33).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(34).setPreferredWidth(80);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(34).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(35).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(35).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getTableHeader().setReorderingAllowed(false);
        jTabelaPerfilCarcerarioInternos.setAutoResizeMode(jTabelaPerfilCarcerarioInternos.AUTO_RESIZE_OFF);
        jTabelaPerfilCarcerarioInternos.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        alinharCelulasTabelaPerfilCarcerario();
        conecta.desconecta();
    }

    public void alinharCelulasTabelaPerfilCarcerario() {
        //
        DefaultTableCellRenderer esquerda = new DefaultTableCellRenderer();
        DefaultTableCellRenderer centralizado = new DefaultTableCellRenderer();
        DefaultTableCellRenderer direita = new DefaultTableCellRenderer();
        esquerda.setHorizontalAlignment(SwingConstants.LEFT);
        centralizado.setHorizontalAlignment(SwingConstants.CENTER);
        direita.setHorizontalAlignment(SwingConstants.RIGHT);
        //      
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(1).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(8).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(11).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(12).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(13).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(14).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(15).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(16).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(17).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(18).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(19).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(20).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(21).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(22).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(23).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(24).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(25).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(26).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(27).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(29).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(30).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(31).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(32).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(33).setCellRenderer(centralizado);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(35).setCellRenderer(centralizado);
    }

    public void limparTabelaPerfilCarcerario() {
        ArrayList dados = new ArrayList();
        String[] Colunas = new String[]{"Nome do Interno", "Ano Nasc.", "Sexo", "Opção Sexual", "Escolaridade", "Pavilhão", "Cor/Etinia", "RG", "CPF", "Cidade", "Bairro", "RF", "CF", "FSRP", "F>21", "F<21", "FRBG", "TV", "FEU", "FENEN", "AL", "Int.Trab.", "TCA", "TM", "USOD", "USAD", "HIP", "DIAB", "TUB", "SIF", "HIV", "HEP", "HAN", "ART", "REU", "AF"};
        ModeloTabela modelo = new ModeloTabela(dados, Colunas);
        jTabelaPerfilCarcerarioInternos.setModel(modelo);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(0).setPreferredWidth(270);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(0).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(1).setPreferredWidth(60);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(1).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(2).setPreferredWidth(80);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(2).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(3).setPreferredWidth(100);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(3).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(4).setPreferredWidth(100);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(4).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(5).setPreferredWidth(100);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(5).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(6).setPreferredWidth(80);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(6).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(7).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(7).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(8).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(8).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(9).setPreferredWidth(220);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(9).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(10).setPreferredWidth(150);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(10).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(11).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(11).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(12).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(12).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(13).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(13).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(14).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(14).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(15).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(15).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(16).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(16).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(17).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(17).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(18).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(18).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(19).setPreferredWidth(50);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(19).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(20).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(20).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(21).setPreferredWidth(60);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(21).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(22).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(22).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(23).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(23).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(24).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(24).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(25).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(25).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(26).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(26).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(27).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(27).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(28).setPreferredWidth(80);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(28).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(29).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(29).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(30).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(30).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(31).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(31).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(32).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(32).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(33).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(33).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(34).setPreferredWidth(80);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(34).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(35).setPreferredWidth(40);
        jTabelaPerfilCarcerarioInternos.getColumnModel().getColumn(35).setResizable(false);
        jTabelaPerfilCarcerarioInternos.getTableHeader().setReorderingAllowed(false);
        jTabelaPerfilCarcerarioInternos.setAutoResizeMode(jTabelaPerfilCarcerarioInternos.AUTO_RESIZE_OFF);
        jTabelaPerfilCarcerarioInternos.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        modelo.getLinhas().clear();
    }
}
